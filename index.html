<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhD Course: Advanced Mining Explosives & Industrial Fire Protection</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        /* CSS Custom Properties - Light Blue Theme */
        :root {
            --bg-color: #f0f9ff; /* Light blue background */
            --text-color-main: #0369a1; /* Sky blue text */
            --text-color-header: #0c4a6e; /* Darker blue for headers */
            --text-color-accent: #075985; /* Accent blue */
            --text-color-subtle: #0ea5e9; /* Lighter accent blue */
            --border-color-light: #e0f2fe; /* Very light blue border */
            --border-color-medium: #bae6fd; /* Medium blue border */
            --border-color-dark: #7dd3fc; /* Darker blue border */
            --accent-color: #38bdf8; /* Bright blue accent */
            --highlight-bg: #e0f2fe; /* Background for highlights */
            --vis-bg-color: #f8fafc; /* Background for visualizations (slightly off-white) */
            --vis-border-color: #cbd5e1; /* Border for visualizations (light gray) */
            --header-grad-from: #0ea5e9; /* Header gradient start */
            --header-grad-to: #0369a1; /* Header gradient end */
            --error-color: #ef4444; /* Red for errors/warnings */
        }
        /* Smooth scrolling behavior */
        html { scroll-padding-top: 110px; }
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
            color: var(--text-color-main);
            background-color: var(--bg-color);
            font-size: 1rem;
            line-height: 1.7;
        }
        main.container { padding-top: 1rem; padding-bottom: 1rem; }

        /* Fade-in animation */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        .dynamic-content { animation: fadeIn 0.6s ease-out forwards; }

        /* --- Interactive Element Styling --- */
        label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--text-color-accent); font-size: 0.9rem; }
        input[type="range"], select { width: 100%; padding: 0.5rem; border: 1px solid var(--border-color-medium); border-radius: 0.375rem; background-color: white; color: var(--text-color-main); font-size: 0.9rem; transition: border-color 0.2s ease; }
        input[type="range"]:focus, select:focus { outline: 2px solid transparent; outline-offset: 2px; border-color: var(--accent-color); box-shadow: 0 0 0 2px var(--highlight-bg); }
        input[type="range"] { cursor: pointer; accent-color: var(--accent-color); padding: 0; height: 0.5rem; appearance: none; background: var(--border-color-light); border-radius: 9999px; border: 1px solid var(--border-color-medium); }
        input[type="range"]::-webkit-slider-thumb { appearance: none; width: 1rem; height: 1rem; background: var(--accent-color); border-radius: 50%; cursor: pointer; border: 1px solid var(--text-color-accent); }
        input[type="range"]::-moz-range-thumb { width: 1rem; height: 1rem; background: var(--accent-color); border-radius: 50%; cursor: pointer; border: 1px solid var(--text-color-accent); }
        button { background-color: var(--accent-color); color: var(--text-color-header); padding: 0.5rem 1rem; border-radius: 0.375rem; font-weight: 500; transition: background-color 0.2s ease, transform 0.1s ease; border: none; cursor: pointer; }
        button:hover { background-color: var(--border-color-dark); }
        .output-box { background-color: var(--highlight-bg); border: 1px solid var(--border-color-medium); color: var(--text-color-accent); padding: 0.5rem 0.75rem; border-radius: 0.375rem; margin-top: 0.5rem; text-align: center; font-weight: 500; font-size: 0.85rem; min-height: 2.5rem; display: flex; align-items: center; justify-content: center; }
        .critical-diameter-output { color: var(--text-color-header); font-size: 1.1rem; font-weight: 600; }
        .rpn-output { color: var(--text-color-header); font-size: 1.1rem; font-weight: 600; }
        .interactive-container { background-color: #ffffff; border: 1px solid var(--border-color-light); padding: 1.5rem; border-radius: 0.5rem; margin-top: 1rem; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05); }
        .visualization-box { background-color: var(--vis-bg-color); border: 1px dashed var(--vis-border-color); min-height: 250px; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 1rem; margin-top: 1rem; text-align: center; position: relative; overflow: hidden; transition: background-color 0.3s ease; font-size: 0.9rem; }
        .visualization-box svg { display: block; margin: auto; max-width: 100%; height: auto; }
        .instructional-text { color: var(--text-color-subtle); font-size: 0.875rem; margin-top: 0.5rem; margin-bottom: 1rem; text-align: center; }
        .warning-note { color: var(--error-color); font-weight: 500; font-size: 0.75rem; text-align: center; margin-top: 0.5rem; font-style: italic; }
        .warning-note strong { font-weight: bold; color: inherit; } /* Allow bold within warnings */

        /* --- Table Styling --- */
        table { width: 100%; border-collapse: collapse; margin-top: 1rem; font-size: 0.85rem; }
        th, td { border: 1px solid var(--border-color-medium); color: var(--text-color-main); padding: 0.6rem; text-align: left; vertical-align: top; }
        th { background-color: var(--highlight-bg); font-weight: 600; color: var(--text-color-accent); position: sticky; top: 110px; z-index: 5; }
        tbody tr:nth-child(odd) { background-color: var(--vis-bg-color); }
        tbody tr:hover { background-color: var(--highlight-bg); }

        /* --- Typography & Content Styling --- */
        h1, h2, h3, h4 { color: var(--text-color-header); font-weight: 700; line-height: 1.3; }
        h1 { font-size: 2.25rem; }
        h2 { font-size: 1.75rem; border-bottom: 2px solid var(--border-color-dark); padding-bottom: 0.5rem; margin-bottom: 1.5rem; margin-top: 2rem; }
        h3 { font-size: 1.3rem; margin-top: 1.5rem; margin-bottom: 0.75rem; }
        h4 { font-size: 1.1rem; margin-top: 1.25rem; margin-bottom: 0.5rem; color: var(--text-color-accent); }
        p, li { color: var(--text-color-main); margin-bottom: 1.25rem; font-size: 0.95rem; text-align: left; }
        ul { list-style: disc; padding-left: 1.5rem; margin-bottom: 1.25rem; }
        /* Limit use of strong tag */
        p strong, li strong { color: var(--text-color-accent); font-weight: 600; } /* Default strong style */
        .key-concept strong { color: var(--text-color-header); font-weight: 600; } /* Specific style for key concepts */
        code { background-color: var(--highlight-bg); color: var(--text-color-accent); padding: 0.2em 0.4em; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
        blockquote { border-left: 4px solid var(--accent-color); padding: 0.75rem 1rem; margin: 1.5rem 0; font-style: italic; color: var(--text-color-subtle); background-color: var(--highlight-bg); font-size: 0.95rem; }
        .section-bg-white { background-color: #ffffff; }
        .equation { background-color: var(--highlight-bg); padding: 0.5rem; border-radius: 4px; border: 1px solid var(--border-color-light); color: var(--text-color-main); display: block; text-align: center; margin: 1.25rem auto; font-size: 1.1rem; overflow-x: auto; }
        .key-concept { border: 1px solid var(--border-color-medium); background-color: var(--vis-bg-color); padding: 1rem; border-radius: 0.375rem; margin: 1.5rem 0; }
        figure { margin: 1.5rem auto; text-align: center; }
        figure svg, figure img { max-width: 100%; height: auto; border: 1px solid var(--border-color-medium); border-radius: 0.375rem; margin: 0 auto 0.5rem auto; display: block; background-color: var(--vis-bg-color); }
        figcaption, .caption { font-size: 0.8rem; color: var(--text-color-subtle); margin-top: 0.25rem; text-align: center; }

        /* --- D3 Plot Styling --- */
        .d3-plot .axis path, .d3-plot .axis line { stroke: var(--border-color-medium); }
        .d3-plot .axis text { fill: var(--text-color-main); }
        .d3-plot .grid line { stroke: var(--border-color-light); }
        .d3-plot .line { fill: none; stroke-width: 2px; }
        .d3-plot path { fill: none; }
        .d3-plot .lfl-line { stroke: var(--accent-color); }
        .d3-plot .ufl-line { stroke: var(--error-color); }
        .d3-plot .prop-yield-line { stroke: var(--text-color-accent); }
        .d3-plot .prop-elastic-line { stroke: var(--accent-color); stroke-dasharray: 4 2; }
        .d3-plot .concrete-line { stroke: var(--text-color-subtle); }
        .plot-label { fill: var(--text-color-accent); }
        .d3-plot .selected-temp-line { stroke: var(--error-color); stroke-dasharray: 3 3; }
        .d3-plot .selected-temp-point { fill: var(--error-color); }
        .d3-plot .selected-smd-line { stroke: var(--accent-yellow); stroke-dasharray: 4 4; }

        /* --- Footer Styling --- */
        footer { border-top: 1px solid var(--border-color-medium); margin-top: 3rem; padding-top: 1.5rem; }
        footer p { font-size: 0.8rem; line-height: 1.5; text-align: center; color: var(--text-color-main);}
        footer a { color: var(--text-color-subtle); text-decoration: underline; }
        footer a:hover { color: var(--text-color-header); }

        /* --- Header/Nav Specific --- */
         header { background: linear-gradient(to right, var(--header-grad-from), var(--header-grad-to)); }
         nav { background-color: var(--border-color-light); border-bottom: 1px solid var(--border-color-medium); top: 88px; }
         nav a { color: var(--text-color-accent); }
         nav a:hover { color: var(--text-color-header); }
         nav span { color: var(--text-color-header); }

    </style>
</head>

<body class="antialiased">

    <header class="bg-gradient-to-r from-[var(--header-grad-from)] to-[var(--header-grad-to)] text-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-6 py-5">
            <h1 class="text-3xl font-bold">PhD Course: Managing High-Energy Release Hazards</h1>
            <p class="text-sky-100 text-xs mt-2">An Advanced Exploration of Fire Dynamics, Explosives Technology, Structural Response, and Risk Assessment for Industrial & Extractive Environments</p>
        </div>
    </header>

    <nav class="sticky top-[88px] bg-sky-50 border-b border-sky-200 z-40 mb-4">
        <div class="container mx-auto px-6 py-2 text-sm flex flex-wrap justify-center">
            <span class="font-semibold text-sky-800 mr-3 mb-1 sm:mb-0">Sections:</span>
            <a href="#hazard_fundamentals" class="text-sky-700 hover:text-sky-900 mr-3 mb-1 sm:mb-0">1. Fundamentals</a> |
            <a href="#fire_dynamics" class="text-sky-700 hover:text-sky-900 mx-3 mb-1 sm:mb-0">2. Fire & Aerosols</a> |
            <a href="#detonation_physics" class="text-sky-700 hover:text-sky-900 mx-3 mb-1 sm:mb-0">3. Detonation</a> |
            <a href="#initiation_sensitivity" class="text-sky-700 hover:text-sky-900 mx-3 mb-1 sm:mb-0">4. Initiation</a> |
            <a href="#structural_response" class="text-sky-700 hover:text-sky-900 mx-3 mb-1 sm:mb-0">5. Structures</a> |
            <a href="#risk_mitigation" class="text-sky-700 hover:text-sky-900 mx-3 mb-1 sm:mb-0">6. Risk & Mitigation</a> |
            <a href="#modeling" class="text-sky-700 hover:text-sky-900 mx-3 mb-1 sm:mb-0">7. Modelling</a> |
            <a href="#interactive" class="text-sky-700 hover:text-sky-900 mx-3 mb-1 sm:mb-0">8. Interactive</a> |
            <a href="#outlook" class="text-sky-700 hover:text-sky-900 ml-3 mb-1 sm:mb-0">9. Outlook</a>
        </div>
    </nav>

    <main class="container mx-auto px-6 py-2">

        <section id="hazard_fundamentals" class="mb-12 pt-4 p-6 rounded-lg shadow-lg section-bg-white dynamic-content">
            <h2 class="text-2xl font-bold">1. Fundamentals of High-Energy Release Hazards</h2>
            <p>This doctoral course adopts a fundamental physics and engineering approach to understanding, predicting, and mitigating hazards associated with rapid energy release in industrial and extractive environments. We bridge the traditionally separate fields of fire science and explosives engineering by focusing on the underlying principles governing combustion, deflagration, detonation, blast wave propagation, and their interaction with structures and materials.</p>
            <ul>
                <li>Thermodynamics & Kinetics: Review of chemical thermodynamics (enthalpy of formation/reaction, equilibrium calculations - CEA codes) and chemical kinetics (Arrhenius law, reaction mechanisms, characteristic timescales) applied to combustion and detonation processes.</li>
                <li>Fluid Dynamics & Transport Phenomena: Principles of compressible flow, shock physics (Rankine-Hugoniot relations), turbulent mixing, multi-phase flow (aerosols, dusts), heat and mass transfer under extreme conditions.</li>
                <li>Continuum Mechanics & Material Science: Stress/strain relationships, constitutive models for materials (metals, concrete, rock, polymers) under high strain rates and elevated temperatures, fracture mechanics, failure criteria.</li>
                <li>Core Distinction: Establishing the fundamental differences between deflagration (subsonic reaction wave driven by thermal diffusion) and detonation (supersonic wave driven by shock compression), and the conditions leading to transition (DDT).</li>
            </ul>
            <div class="key-concept mt-6">
                <strong>Course Philosophy:</strong> To equip PhD researchers with the fundamental knowledge and analytical tools to tackle complex safety challenges involving fire, explosion, and blast hazards across diverse industrial settings, moving beyond prescriptive rules towards first-principles understanding and performance-based solutions.
            </div>
        </section>

        <section id="fire_dynamics" class="mb-12 pt-4 p-6 rounded-lg shadow-lg section-bg-white dynamic-content">
            <h2 class="text-2xl font-bold">2. Advanced Fire Dynamics & Aerosol Hazards</h2>
            <p>Examining fire development in enclosures and the specific, often misunderstood, hazards of flammable aerosols (mists/sprays), often encountered in industrial and mining environments through leaks or process upsets. Content draws significantly from the review by Yuan et al. (2021).</p>
             <ul>
                <li>The Aerosol Hazard Paradigm: Emphasis on the inadequacy of flashpoint as the sole criterion for liquid flammability when aerosolization occurs. Discussion of the multi-dimensional flammability region for aerosols depending on concentration, temperature, and crucially, droplet size distribution (SMD).</li>
                <li>Aerosol Generation & Characterization: Mechanisms relevant to industrial/mining scenarios: pressure release, flashing releases, mechanical dispersion. Characterization techniques (Laser Diffraction, PDA, PIV) and parameters (SMD). Predictive correlations.</li>
                <li>Aerosol Flammability Limits: Complex relationship between droplet size and LFL/UFL. Observed LFL reduction for larger droplets and potential mechanisms (sedimentation, local stoichiometry). Discussion of contradictory findings in literature. Higher UFL for aerosols vs. vapors.</li>
                <li>Aerosol Explosion Dynamics & Severity: Measurement and significance of \(P_{max}\) and Deflagration Index (\(K_a\)). Influence of experimental scale on measured parameters. Role of volatility and droplet size.
                    <div class="equation">
                     K_a = V^{1/3} \left( \frac{dP}{dt} \right)_{max}
                    </div>
                </li>
                 <li>Deflagration-to-Detonation Transition (DDT) in Aerosols: Potential for DDT. Review of experimental evidence and factors influencing DDT propensity (concentration, confinement, ignition). Links to gas/dust DDT mechanisms.</li>
                 <li>Enclosure Fire Dynamics (Advanced): Zone vs. CFD models (FDS). Ventilation vs. fuel control. HRRPUA. Flashover criteria. Plume theory limitations. Advanced heat transfer (convection, radiation modelling). Equation: \( \dot{q}''_{net} = h_c (T_{gas} - T_{surf}) + \epsilon_{surf} \sigma ( \epsilon_{gas} T_{gas}^4 - \alpha_{surf} T_{surf}^4 ) \).</li>
            </ul>
            <div class="key-concept mt-6">
                <strong>PhD Challenge (Aerosols/Fire):</strong> Develop standardized aerosol testing methods. Resolve LFL contradictions. Elucidate aerosol DDT mechanisms. Validate CFD for complex enclosure fires with aerosols.
            </div>
        </section>

        <section id="detonation_physics" class="mb-12 pt-4 p-6 rounded-lg shadow-lg section-bg-white dynamic-content">
            <h2 class="text-2xl font-bold">3. Detonation Physics & Non-Ideal Behaviour</h2>
            <p>Delving into the physics of detonation waves, particularly the non-ideal behaviour characteristic of commercial explosives used in mining and demolition.</p>
             <ul>
                <li>Non-Ideal Detonation Theory: Limitations of CJ theory. Detonation Shock Dynamics (DSD) \(D_n(\kappa)\). Reaction zone structure \(l_{rz}\). Curvature effects. Failure diameter \(d_f\). Role of confinement.</li>
                <li>Equation of State (EOS) & Thermochemistry: Review of EOS models (Ideal Gas, JWL, BKW). Thermochemical codes (CHEETAH, EXPLO5). Parameterization challenges. Impact on predicted \(P_{det}, D_{det}\).</li>
                <li>Performance Metrics & Measurement: Advanced VOD techniques. Pressure measurement challenges (underwater tests, gauges). Energy output determination (cylinder expansion, calorimetry).</li>
                <li>Rock Interaction & Fragmentation: Stress wave propagation. Dynamic fracture. Shock vs. heave energy. Blast design influence. Numerical fragmentation models (Hydrocode+Fracture/DEM).</li>
            </ul>
             <div class="key-concept mt-6">
                <strong>PhD Challenge (Detonation):</strong> Develop predictive EOS/reactive burn models for non-ideal explosives under mining conditions. Improve quantitative links between explosive properties, blast design, geology, and fragmentation outcomes.
            </div>
        </section>

        <section id="initiation_sensitivity" class="mb-12 pt-4 p-6 rounded-lg shadow-lg section-bg-white dynamic-content">
             <h2 class="text-2xl font-bold">4. Initiation Systems & Explosive Sensitivity</h2>
             <p>Examining the science and technology of reliably initiating explosives while ensuring safety through understanding sensitivity to various stimuli.</p>
              <ul>
                 <li>The Initiation Train: Energy transfer sequence. Detonator output characterization (shock profile, timing - electronics). Booster selection criteria (sensitivity, output matching, impedance). SDT physics at interfaces.</li>
                 <li>Shock Initiation & SDT: Hot spot mechanisms (void collapse, shear). Critical energy/pressure criteria (\(P^n \tau\)). Pop-plots. Reactive burn models (Lee-Tarver). Run distance \(X_{SDT}\).</li>
                 <li>Critical Diameter (\(d_c\)) & Failure Diameter (\(d_f\)): Distinction; Dependence on formulation, confinement, initiation; Experimental methods.</li>
                 <li>Sensitivity Assessment & Safety Science: Interpretation of standard tests (UN Gap, BAM Impact/Friction). Limitations. Advanced concepts (critical shock pressure, thermal stability - DSC/ARC/Cook-off). Role of formulation.</li>
             </ul>
             <blockquote class="my-4">
                 Understanding the complex interplay between initiation system parameters, explosive sensitivity, and confinement is crucial for designing effective blasting patterns while minimizing risks like misfires or sympathetic detonation.
             </blockquote>
        </section>

        <section id="structural_response" class="mb-12 pt-4 p-6 rounded-lg shadow-lg section-bg-white dynamic-content">
            <h2 class="text-2xl font-bold">5. Structural Response to Fire & Blast Loads</h2>
            <p>Analyzing the behaviour of structures subjected to extreme thermal (fire) and dynamic (blast) loading conditions encountered in industrial and mining environments.</p>
            <ul>
                <li>Material Behaviour Under Extreme Conditions: Temperature-dependent mechanical properties (\(E_\theta, f_{y,\theta}, f_{c,\theta}\)). High strain-rate material behaviour (e.g., Johnson-Cook models). Creep under fire vs. dynamic strength under blast.</li>
                <li>Structural Fire Engineering Analysis: Methods (simple vs. advanced FEM - SAFIR, OpenSees, ABAQUS); Thermal analysis; Mechanical analysis (thermal expansion, restraint, buckling, membrane action, connections); Progressive collapse assessment.</li>
                <li>Blast Loading on Structures: Blast wave characterization (Friedlander waveform); Load application (pressure-time histories, FSI); Structural response modes (direct pressure, drag, diffraction); Failure criteria (breaching, spalling, collapse).</li>
                <li>Combined Hazards: Fire following explosion (or vice-versa). Modelling sequential/combined loads. Post-event structural assessment.</li>
                <li>Protective Structures: Design principles for fire-rated compartments and blast-resistant structures (bunkers, control rooms, refuge chambers).</li>
            </ul>
            <div class="key-concept mt-6">
                <strong>PhD Challenge (Structures):** Develop high-fidelity models for structural response under combined/sequential fire and blast loading. Improve understanding of connection behaviour under extreme loads. Create efficient methods for assessing post-event structural integrity.
            </div>
        </section>

        <section id="risk_mitigation" class="mb-12 pt-4 p-6 rounded-lg shadow-lg section-bg-white dynamic-content">
            <h2 class="text-2xl font-bold">6. Risk Assessment & Mitigation Strategies</h2>
            <p>Applying systematic methodologies for identifying, analysing, and mitigating fire and explosion risks in mining and industrial settings, incorporating advanced techniques discussed in Soltani et al. (2024).</p>
             <ul>
                <li>Hazard Identification: Techniques (HAZID, HAZOP) applied to fire (aerosols, conveyors, electrical, spontaneous combustion) and explosives (handling, storage, misfires, flyrock, fumes, security) scenarios in mining. Use of incident databases.</li>
                <li>Advanced Risk Assessment Methods: Limitations of classical RPN (Fine-Kinney). Introduction to Fuzzy Logic for handling uncertainty (TFNs, linguistic variables - Soltani Table 7). Application of MCDM:
                    <ul>
                       <li>FBWM: For robust criteria weighting (e.g., C, P, E) (Soltani Eq 8, Table 11).</li>
                       <li>GRA: For ranking risks (Soltani Eq 16, 17, Table 14). Discussion of specific high-ranked blasting risks from Soltani et al. (R12, R15, R23).</li>
                    </ul>
                     <div class="equation">
                        \Gamma_i = \sum w_j \gamma(X_{0j}, x_{ij}) \quad \text{(GRA Grade Calculation)}
                     </div>
                </li>
                 <li>Consequence Modelling: Use of CFD (FDS) for fire/smoke spread; Hydrocodes (AUTODYN) or empirical models for blast wave propagation; Aerosol dispersion models.</li>
                 <li>Mitigation & Control Strategies:
                     <ul>
                        <li>Fire: Ventilation control, advanced detection (FO-DTS), suppression (water mist, foam, inerting), passive protection.</li>
                        <li>Explosives: Storage regulations, handling procedures (anti-static), initiation system safety, blast design, fume clearance, security.</li>
                    </ul>
                 </li>
                 <li>Regulatory Context: ATEX, MSHA, NFPA codes, UN transport regulations. Role of QRA and PBD.</li>
             </ul>
             <div class="key-concept mt-6">
                <strong>PhD Challenge (Risk/Mitigation):** Integrate advanced consequence models within probabilistic risk assessment frameworks (QRA). Develop dynamic risk assessment tools. Optimize mitigation strategies using simulation and cost-benefit analysis. Validate fuzzy/MCDM approaches against real-world data.
            </div>
        </section>

        <section id="modeling" class="mb-12 pt-4 p-6 rounded-lg shadow-lg section-bg-white dynamic-content">
            <h2 class="text-2xl font-bold">7. Advanced Modelling & Simulation</h2>
             <p>Computational modelling is indispensable for tackling the complexity of fire, explosion, and blast phenomena at a PhD level.</p>
             <ul>
                <li>CFD for Fire & Ventilation: FDS, OpenFOAM applications; Challenges (turbulence, combustion, radiation, soot, V&V, HPC).</li>
                <li>Hydrocodes for Blasting & Explosions: AUTODYN, LS-DYNA applications; Challenges (EOS/reactive burn models, rock/concrete models, V&V, FSI).</li>
                <li>Coupled & Multi-Scale Modelling: CFD-FEM, micro-macro material links, blast-geomechanics, evacuation-fire coupling, Uncertainty Quantification (UQ) methods.</li>
             </ul>
              <blockquote class="my-4">
                A key focus for PhD research is often the development, implementation, and rigorous validation of novel numerical methods or sub-models within these advanced simulation frameworks, including robust UQ.
            </blockquote>
        </section>

        <section id="interactive" class="mb-12 pt-4 p-6 rounded-lg shadow-lg section-bg-white dynamic-content">
            <h2 class="text-2xl font-bold">8. Interactive Exploration Tools</h2>
            <p>Explore key concepts discussed in the course through interactive visualizations. These tools use simplified models for educational illustration ONLY and should not be used for design or safety decisions.</p>

            {/* Interactive 1: Material Property Degradation */}
            <div class="interactive-container mt-4">
                <h3 class="text-xl font-semibold mb-2 text-center">Material Property Degradation (Fire)</h3>
                <p class="instructional-text">Select a material and property to see how its relative strength or stiffness changes with temperature according to simplified Eurocode models.</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                    <div>
                        <label for="materialSelect">Material:</label>
                        <select id="materialSelect" name="materialSelect" class="cursor-pointer">
                            <option value="steel" selected>Structural Steel</option>
                            <option value="concrete">Normal Weight Concrete (Siliceous)</option>
                        </select>
                    </div>
                    <div>
                        <label for="propertySelect">Property:</label>
                        <select id="propertySelect" name="propertySelect" class="cursor-pointer">
                            <option value="yield" selected>Yield Strength / Comp. Strength</option>
                            <option value="elastic">Elastic Modulus</option>
                        </select>
                    </div>
                    <div>
                        <label for="temperatureSlider">Temperature (°C):</label>
                        <input type="range" id="temperatureSlider" name="temperatureSlider" min="20" max="1200" value="400" step="10">
                        <div class="output-box">T = <span id="temperatureValue">400</span> °C | k ≈ <span id="reductionFactorValue">0.00</span></div>
                    </div>
                </div>
                <div class="visualization-box">
                    <div id="material-property-plot" class="w-full h-72 d3-plot"></div>
                    <p class="text-xs mt-2 caption">Plot of Reduction Factor (k) vs. Temperature (°C). Vertical line indicates selected temperature.</p>
                </div>
                 <p class="warning-note mt-4">Disclaimer: Uses simplified Eurocode models. Actual behaviour varies. Consult standards for design.</p>
            </div>

            {/* Divider */}
            <div class="my-10 border-t border-dashed border-[var(--border-color-medium)]"></div>

            {/* Interactive 2: Explosives Initiation Concept */}
            <div class="interactive-container mt-4">
                <h3 class="text-xl font-semibold mb-2 text-center">Explosives Initiation Concept</h3>
                <p class="instructional-text">Explore the conceptual relationship between booster output, main charge sensitivity, confinement, and the resulting critical diameter required for reliable initiation.</p>
                 <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4 items-end">
                     <div> <label for="boosterOutputSlider">Booster Output (Conceptual):</label> <input type="range" id="boosterOutputSlider" name="boosterOutputSlider" min="1" max="10" value="5" step="1"> <div class="output-box"><span id="boosterOutputValue">5</span> (Rel. Units)</div> </div>
                     <div> <label for="chargeSensitivitySlider">Main Charge Sensitivity:</label> <input type="range" id="chargeSensitivitySlider" name="chargeSensitivitySlider" min="1" max="5" value="3" step="1"> <div class="output-box"><span id="chargeSensitivityValue">Medium</span></div> </div>
                     <div> <label for="confinementSlider">Confinement Level:</label> <input type="range" id="confinementSlider" name="confinementSlider" min="1" max="4" value="2" step="1"> <div class="output-box"><span id="confinementValue">Low</span></div> </div>
                     <div class="flex flex-col items-center justify-center"> <label class="text-center">Conceptual Critical Diameter:</label> <div id="criticalDiameterOutput" class="output-box critical-diameter-output w-full">-- mm</div> </div>
                 </div>
                 <div id="initiation-explanation" class="interactive-output mt-6 text-sm text-left space-y-1" style="border-left-color: var(--accent-color); background-color: var(--vis-bg-color);"> <p>Adjust sliders...</p> </div>
                 <p class="warning-note mt-4"><strong>Warning:</strong> Highly simplified conceptual model. Explosives are extremely dangerous.</p>
            </div>

            {/* Divider */}
            <div class="my-10 border-t border-dashed border-[var(--border-color-medium)]"></div>

            {/* Interactive 3: Aerosol Flammability Concept */}
            <div class="interactive-container mt-4">
                <h3 class="text-xl font-semibold mb-2 text-center">Aerosol Flammability Limits Concept</h3>
                <p class="instructional-text">Visualize the conceptual effect of aerosol Sauter Mean Diameter (SMD) on the Lower and Upper Flammability Limits (LFL/UFL), based on trends discussed in Yuan et al. (2021).</p>
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                    <div> <label for="smdSlider">Droplet SMD (µm):</label> <input type="range" id="smdSlider" name="smdSlider" min="5" max="500" value="50" step="5"> <div class="output-box">SMD = <span id="smdValue">50</span> µm</div> </div>
                    <div> <label>Conceptual Flammability Range:</label> <div id="flammabilityRangeOutput" class="output-box">LFL: -- g/m³ | UFL: -- g/m³</div> </div>
                </div>
                <div class="visualization-box"> <div id="aerosol-flammability-plot" class="w-full h-64 d3-plot"></div> <p class="text-xs mt-2 caption">Conceptual plot: Limits (g/m³, log) vs. SMD (µm). Dashed lines = gas limits.</p> </div>
                <p class="warning-note mt-4">Disclaimer: Illustrative model based on general trends and conflicting literature. Actual limits require experiments.</p>
            </div>

             {/* Divider */}
            <div class="my-10 border-t border-dashed border-[var(--border-color-medium)]"></div>

             {/* Interactive 4: Fuzzy Risk Prioritization Concept */}
            <div class="interactive-container mt-4">
                <h3 class="text-xl font-semibold mb-2 text-center">Fuzzy Risk Prioritization Concept (Fine-Kinney)</h3>
                <p class="instructional-text">Explore how linguistic assessments of Consequence, Probability, and Exposure, combined with criteria weights (from Soltani et al.), influence a conceptual Risk Priority Number (RPN) using fuzzy logic principles.</p>
                 <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4 items-end">
                     <div> <label for="consequenceSelect">Consequence (C):</label> <select id="consequenceSelect" name="consequenceSelect" class="cursor-pointer"> <option value="VL">Very Low (VL)</option> <option value="L">Low (L)</option> <option value="LM">Low-Moderate (LM)</option> <option value="M" selected>Moderate (M)</option> <option value="AH">Almost High (AH)</option> <option value="H">High (H)</option> <option value="VH">Very High (VH)</option> </select> <div class="output-box text-xs">Weight (w_C) ≈ 0.538</div> </div>
                     <div> <label for="probabilitySelect">Probability (P):</label> <select id="probabilitySelect" name="probabilitySelect" class="cursor-pointer"> <option value="VL">Very Low (VL)</option> <option value="L" selected>Low (L)</option> <option value="LM">Low-Moderate (LM)</option> <option value="M">Moderate (M)</option> <option value="AH">Almost High (AH)</option> <option value="H">High (H)</option> <option value="VH">Very High (VH)</option> </select> <div class="output-box text-xs">Weight (w_P) ≈ 0.294</div> </div>
                     <div> <label for="exposureSelect">Exposure (E):</label> <select id="exposureSelect" name="exposureSelect" class="cursor-pointer"> <option value="VL">Very Low (VL)</option> <option value="L">Low (L)</option> <option value="LM" selected>Low-Moderate (LM)</option> <option value="M">Moderate (M)</option> <option value="AH">Almost High (AH)</option> <option value="H">High (H)</option> <option value="VH">Very High (VH)</option> </select> <div class="output-box text-xs">Weight (w_E) ≈ 0.167</div> </div>
                     <div class="flex flex-col items-center justify-center"> <label class="text-center">Conceptual Weighted RPN:</label> <div id="rpnOutput" class="output-box rpn-output w-full">--</div> <div id="rpnRiskLevel" class="text-sm font-semibold mt-1">--</div> </div>
                 </div>
                 <div id="risk-explanation" class="interactive-output mt-6 text-sm text-left space-y-1" style="border-left-color: var(--accent-color); background-color: var(--vis-bg-color);"> <p>Select linguistic ratings...</p> </div>
                 <p class="warning-note mt-4">Note: Simplified calculation for illustration. Real fuzzy risk assessment involves more complex methods.</p>
            </div>

        </section>

        <section id="outlook" class="mb-12 pt-4 p-6 rounded-lg shadow-lg section-bg-white dynamic-content">
            <h2 class="text-2xl font-bold">9. Outlook: Challenges & Future Directions</h2>
             <p>Research and development in managing high-energy release hazards remain critical for improving safety, efficiency, and sustainability in essential industries.</p>
             <h3 class="text-xl font-semibold mt-4 mb-2">Key Research Directions:</h3>
            <ul class="list-disc list-inside space-y-1 pl-4">
                <li>Integrating Multi-Physics & Multi-Scale Modelling (Detonation, Fire, Structure, Geomechanics).</li>
                <li>Data-Driven Approaches & AI/ML in Risk, Performance Prediction, and Diagnostics.</li>
                <li>Advanced Material Characterization & Development (Energetics, Fire/Blast Resistive Materials).</li>
                <li>Resilience-Based Design Frameworks for Extreme Events.</li>
                <li>Validation through Advanced, Multi-Scale Experimental Techniques.</li>
                <li>Human Factors, Automation Safety, and Emergency Management in Complex Systems.</li>
                <li>Addressing Hazards of New Technologies (e.g., BEVs, Hydrogen) in Industrial/Mining Contexts.</li>
                <li>Uncertainty Quantification (UQ) across all modelling domains.</li>
            </ul>
            <p>A PhD focusing on these interdisciplinary areas offers the chance to develop cutting-edge solutions with significant real-world impact.</p>
        </section>

        <footer class="mt-16 pt-8 border-t border-sky-200 text-sm text-sky-700">
             <p>
                This webpage provides a conceptual outline for a PhD-level exploration of Managing High-Energy Release Hazards.
                <br>
                Content is illustrative, inspired by current research (e.g., Yuan et al., 2021; Soltani et al., 2024) and educational approaches. Consult primary literature and standards.
            </p>
             <p class="mt-4 text-center text-xs text-sky-600">PhD Course Concept: Managing High-Energy Release Hazards (Light Blue Theme, Final v2)</p>
        </footer>

    </main>

    <script>
        /**
         * Sets up a range slider or select element with value display and callback.
         * Handles linear/log scales for sliders, maps select values.
         * Includes error handling for missing elements.
         */
        function setupControl(controlId, valueId, options = {}) {
            const control = document.getElementById(controlId);
            // Check if control exists
            if (!control) { console.warn(`Control setup failed: Control element #${controlId} not found.`); return; }
            // Value display is optional only for selects where map is used elsewhere
            const valueDisplay = document.getElementById(valueId);
            if (!valueDisplay && !options.isSelect) { console.warn(`Control setup failed: Value display element #${valueId} not found for slider #${controlId}.`); return; }

            const { fixedDigits = 0, logScale = false, callback = null, valueFormatFn = null, isSelect = false, selectMap = null } = options;
            control.isSelect = isSelect; control.logScale = logScale; control.fixedDigits = fixedDigits; control.valueFormatFn = valueFormatFn; control.callback = callback; control.selectMap = selectMap;

            if (!isSelect) { // Range slider setup
                const minAttr = parseFloat(control.min); const maxAttr = parseFloat(control.max);
                let safeMin = isNaN(minAttr) ? (logScale ? 1e-6 : 0) : (logScale ? Math.max(1e-9, minAttr) : minAttr);
                let safeMax = isNaN(maxAttr) ? safeMin * (logScale ? 1000 : 100) : (logScale ? Math.max(safeMin * 1.1, maxAttr) : Math.max(safeMin + 1e-9, maxAttr));
                if (safeMax <= safeMin) { safeMax = safeMin * (logScale ? 10 : 2); if (safeMax <= safeMin) safeMax = safeMin + 1; }
                control.logMinVal = safeMin; control.logMaxVal = safeMax;
                const initialValueAttr = control.getAttribute('value'); let initialActualValue = initialValueAttr ? parseFloat(initialValueAttr) : (logScale ? control.logMinVal : safeMin);
                initialActualValue = Math.max(safeMin, Math.min(safeMax, initialActualValue)); if (!isFinite(initialActualValue)) { initialActualValue = logScale ? control.logMinVal : safeMin; }
                if (logScale) { const minLog = Math.log10(control.logMinVal); const maxLog = Math.log10(control.logMaxVal); const range = maxLog - minLog; let initialSliderPos = 0; if (range > 0 && initialActualValue > 0 && isFinite(range)) { const valueLog = Math.log10(initialActualValue); initialSliderPos = Math.round(((valueLog - minLog) / range) * 100); } control.min = "0"; control.max = "100"; control.step = "1"; control.value = initialSliderPos; } else { control.min = safeMin.toString(); control.max = safeMax.toString(); const range = safeMax - safeMin; let step = (range > 0) ? (range / 100) : 1e-6; if (range > 0) { const magnitude = Math.pow(10, Math.floor(Math.log10(step))); step = Math.max(1e-6, magnitude / 10); } control.step = step.toExponential(1); control.value = initialActualValue; }
            } // End range slider setup

            function updateControl() {
                 const currentControl = document.getElementById(controlId);
                 const currentValueDisplay = document.getElementById(valueId); // Re-fetch value display too
                 if (!currentControl) return;

                 let actualValue; let displayValueText;
                 if (currentControl.isSelect) { actualValue = currentControl.value; displayValueText = currentControl.selectMap ? (currentControl.selectMap[actualValue] || actualValue) : actualValue; }
                 else { // Range slider logic
                     const rawValue = parseFloat(currentControl.value);
                     if (isNaN(rawValue)) { actualValue = currentControl.logScale ? currentControl.logMinVal : parseFloat(currentControl.min); }
                     else if (currentControl.logScale) { const minLog = Math.log10(currentControl.logMinVal); const maxLog = Math.log10(currentControl.logMaxVal); const range = maxLog - minLog; const sliderMinInternal = 0; const sliderMaxInternal = 100; const sliderRangeInternal = sliderMaxInternal - sliderMinInternal; if (sliderRangeInternal <= 0 || !isFinite(range) || range <= 0) { actualValue = currentControl.logMinVal; } else { const normalizedSliderValue = Math.max(0, Math.min(1, (rawValue - sliderMinInternal) / sliderRangeInternal)); const valueLog = minLog + normalizedSliderValue * range; actualValue = Math.pow(10, valueLog); } }
                     else { actualValue = rawValue; }
                     if (!isFinite(actualValue)) { actualValue = currentControl.logScale ? currentControl.logMinVal : parseFloat(currentControl.min); }
                     // Format numeric value
                     if (typeof currentControl.valueFormatFn === 'function') { displayValueText = currentControl.valueFormatFn(actualValue); }
                     else if (typeof actualValue !== 'number' || !isFinite(actualValue)) { displayValueText = "NaN"; }
                     else if (currentControl.logScale && Math.abs(actualValue) > 1e-9 && Math.abs(actualValue) < 0.01) { displayValueText = actualValue.toExponential(currentControl.fixedDigits); }
                     else { displayValueText = actualValue.toFixed(currentControl.fixedDigits); }
                 }
                 currentControl.actualValue = actualValue; // Store processed value
                 // Update display only if it exists
                 if (currentValueDisplay) { currentValueDisplay.textContent = displayValueText; }
                 // Trigger callback
                 if (typeof currentControl.callback === 'function') { try { currentControl.callback(); } catch (e) { console.error(`Error in callback for ${controlId}:`, e); } }
             }
            // Use 'input' for sliders, 'change' for selects
            const eventType = isSelect ? 'change' : 'input';
            control.addEventListener(eventType, updateControl);
            // Initial update after setup
            updateControl();
        }


        /** Sets up the SVG and main group ('g') element for a D3 plot. */
        function setupPlotArea(targetId, margin, isDirectSvg = false) {
             let svg, g; let containerWidth, containerHeight;
             if (isDirectSvg) { svg = d3.select(`#${targetId}`); if (svg.empty()) { throw new Error(`Target SVG #${targetId} not found.`); } containerWidth = parseFloat(svg.attr("width")) || 400; containerHeight = parseFloat(svg.attr("height")) || 200; svg.selectAll("g").remove(); g = svg.append("g").attr("id", `${targetId}-plot-group`).attr("class", "d3-plot"); }
             else { const plotDiv = document.getElementById(targetId); if (!plotDiv) { throw new Error(`Plot container #${targetId} not found.`); } containerWidth = plotDiv.clientWidth; containerHeight = plotDiv.clientHeight; if (!containerWidth || !containerHeight || containerWidth <= 0 || containerHeight <= 0) { const parent = plotDiv.parentElement; if(parent && parent.clientWidth > 0 && parent.clientHeight > 0){ containerWidth = parent.clientWidth; containerHeight = parent.clientHeight; if(plotDiv.clientHeight <= 0) plotDiv.style.height = `${containerHeight}px`; } else { throw new Error(`Plot container #${targetId} has invalid dimensions: ${containerWidth}x${containerHeight}.`); } } svg = d3.select(plotDiv).select("svg"); if (svg.empty()) { svg = d3.select(plotDiv).append("svg"); } svg.attr("width", "100%").attr("height", "100%").attr("viewBox", `0 0 ${containerWidth} ${containerHeight}`).attr("preserveAspectRatio", "xMidYMid meet"); svg.selectAll("*").remove(); g = svg.append("g").attr("class", "d3-plot"); }
             g.attr("transform", `translate(${margin.left},${margin.top})`); const plotWidth = containerWidth - margin.left - margin.right; const plotHeight = containerHeight - margin.top - margin.bottom; if (plotWidth <= 0 || plotHeight <= 0) { throw new Error(`Plot area for #${targetId} invalid after margins: ${plotWidth}x${plotHeight}.`); } const dims = { containerWidth, containerHeight, plotWidth, plotHeight }; return { g, dims };
         }

        /** Draws X and Y axes on a D3 plot group. */
        function drawAxes(g, xScale, yScaleLeft, yScaleRight, dims, margin, labels) {
            try {
                g.append("g").attr("class", "x axis").attr("transform", `translate(0,${dims.plotHeight})`).call(d3.axisBottom(xScale).ticks(labels.xTicks || 5).tickFormat(labels.xFormat || d3.format(".0f")));
                g.append("text").attr("class", "plot-label").attr("x", dims.plotWidth / 2).attr("y", dims.plotHeight + margin.bottom - (labels.xOffset || 5)).attr("text-anchor", "middle").text(labels.x || "X Axis");
                const yAxisLeft = g.append("g").attr("class", "y axis left-axis").call(d3.axisLeft(yScaleLeft).ticks(labels.yLeftTicks || 5).tickFormat(labels.yLeftFormat || d3.format(".1f")));
                if (labels.yLeftColor) { yAxisLeft.selectAll("path, line").style("stroke", labels.yLeftColor); yAxisLeft.selectAll("text").style("fill", labels.yLeftColor); }
                g.append("text").attr("class", "plot-label").attr("transform", "rotate(-90)").attr("y", -margin.left + (labels.yLeftOffset || 15)).attr("x", -dims.plotHeight / 2).attr("text-anchor", "middle").style("fill", labels.yLeftColor || 'var(--text-color-accent)').text(labels.yLeft || "Left Y Axis");
                if (yScaleRight && labels.yRight) { const yAxisRight = g.append("g").attr("class", "y axis right-axis").attr("transform", `translate(${dims.plotWidth},0)`).call(d3.axisRight(yScaleRight).ticks(labels.yRightTicks || 5).tickFormat(labels.yRightFormat || d3.format(".1f"))); if (labels.yRightColor) { yAxisRight.selectAll("path, line").style("stroke", labels.yRightColor); yAxisRight.selectAll("text").style("fill", labels.yRightColor); } g.append("text").attr("class", "plot-label").attr("transform", "rotate(90)").attr("y", -dims.plotWidth - margin.right + (labels.yRightOffset || 15)).attr("x", dims.plotHeight / 2).attr("text-anchor", "middle").style("fill", labels.yRightColor || 'var(--text-color-accent)').text(labels.yRight || "Right Y Axis"); }
            } catch (e) { console.error("Error drawing axes:", e); /* Prevent graph breaking */ }
        }

        /** Draws a line on the plot. */
         function drawLine(g, plotData, lineGenerator, cssClass) {
             try {
                 g.selectAll(`path.line.${cssClass.split(' ')[0]}`).remove();
                 g.append("path").datum(plotData).attr("class", `line ${cssClass} d3-plot`).attr("d", lineGenerator).attr("fill", "none").attr("stroke-width", 2);
             } catch (e) { console.error("Error drawing line:", cssClass, e); }
         }

        /** Displays an error message within a plot area. */
        function displayPlotError(targetId, message = "Error rendering plot.", isDirectSvg = false) {
             try { const margin = { top: 10, right: 10, bottom: 10, left: 10 }; const { g, dims } = setupPlotArea(targetId, margin, isDirectSvg); g.append("text").attr("x", dims.plotWidth / 2).attr("y", dims.plotHeight / 2).text(message).style("font-size", "10px").attr("fill", "red").attr("text-anchor", "middle"); } catch (e) { console.error(`Failed to display error in target ${targetId}: ${e.message}`); const targetElement = document.getElementById(targetId); if (targetElement) { targetElement.innerHTML = `<p style="color: red; font-size: 10px; text-align: center;">${message}</p>`; } }
         }

        // --- Eurocode Material Property Functions ---
        function steelYieldReduction(T) { if (T < 400) return 1.0; if (T < 500) return 1.0 - (T - 400) * 0.22 / 100; if (T < 600) return 0.78 - (T - 500) * 0.31 / 100; if (T < 700) return 0.47 - (T - 600) * 0.24 / 100; if (T < 800) return 0.23 - (T - 700) * 0.12 / 100; if (T < 900) return 0.11 - (T - 800) * 0.05 / 100; if (T < 1000) return 0.06 - (T - 900) * 0.02 / 100; if (T < 1100) return 0.04 - (T - 1000) * 0.02 / 100; if (T < 1200) return 0.02 - (T - 1100) * 0.02 / 100; return 0.0; }
        function steelElasticModulusReduction(T) { if (T < 100) return 1.0; if (T < 200) return 1.0 - (T - 100) * 0.1 / 100; if (T < 300) return 0.9 - (T - 200) * 0.1 / 100; if (T < 400) return 0.8 - (T - 300) * 0.1 / 100; if (T < 500) return 0.7 - (T - 400) * 0.1 / 100; if (T < 600) return 0.6 - (T - 500) * 0.29 / 100; if (T < 700) return 0.31 - (T - 600) * 0.18 / 100; if (T < 800) return 0.13 - (T - 700) * 0.04 / 100; if (T < 900) return 0.09 - (T - 800) * 0.0225 / 100; if (T < 1000) return 0.0675 - (T - 900) * 0.0225 / 100; if (T < 1100) return 0.045 - (T - 1000) * 0.0225 / 100; if (T < 1200) return 0.0225 - (T - 1100) * 0.0225 / 100; return 0.0; }
        function concreteStrengthReduction(T) { if (T <= 100) return 1.0; if (T <= 200) return 1.0 - (T-100)*0.05/100; if (T <= 300) return 0.95 - (T-200)*0.10/100; if (T <= 400) return 0.85 - (T-300)*0.10/100; if (T <= 500) return 0.75 - (T-400)*0.15/100; if (T <= 600) return 0.60 - (T-500)*0.15/100; if (T <= 700) return 0.45 - (T-600)*0.15/100; if (T <= 800) return 0.30 - (T-700)*0.15/100; if (T <= 900) return 0.15 - (T-800)*0.07/100; if (T <= 1000) return 0.08 - (T-900)*0.04/100; if (T <= 1100) return 0.04 - (T-1000)*0.03/100; if (T <= 1200) return 0.01 - (T-1100)*0.01/100; return 0.0; }
        function concreteElasticModulusReduction(T) { if (T <= 100) return 1.0; if (T <= 200) return 1.0-(T-100)*0.15/100; if (T <= 300) return 0.85-(T-200)*0.15/100; if (T <= 400) return 0.70-(T-300)*0.15/100; if (T <= 500) return 0.55-(T-400)*0.20/100; if (T <= 600) return 0.35-(T-500)*0.15/100; if (T <= 700) return 0.20-(T-600)*0.10/100; if (T <= 800) return 0.10-(T-700)*0.05/100; if (T <= 900) return 0.05-(T-800)*0.03/100; if (T <= 1000) return 0.02-(T-900)*0.02/100; return 0.0; }

        // --- Interactive Material Plot Logic ---
        function updateMaterialPlot() {
             const plotDivId = "material-property-plot"; const context = "Material Property Plot";
             try {
                 const materialSelect = document.getElementById('materialSelect'); const propertySelect = document.getElementById('propertySelect'); const tempSlider = document.getElementById('temperatureSlider');
                 if (!materialSelect || !propertySelect || !tempSlider || typeof tempSlider.actualValue === 'undefined') { throw new Error("Controls not found/initialized for material plot."); }
                 const material = materialSelect.value; const property = propertySelect.value; const selectedTemp = tempSlider.actualValue;
                 const margin = {top: 20, right: 30, bottom: 40, left: 40}; const { g, dims } = setupPlotArea(plotDivId, margin);
                 const tempRange = d3.range(20, 1201, 10); let reductionFn;
                 if (material === 'steel') { reductionFn = (property === 'yield') ? steelYieldReduction : steelElasticModulusReduction; }
                 else if (material === 'concrete') { reductionFn = (property === 'yield') ? concreteStrengthReduction : concreteElasticModulusReduction; }
                 else { throw new Error(`Unsupported material: ${material}`); }
                 const plotData = tempRange.map(T => { const k = reductionFn(T); return { temp: T, k: (isFinite(k) && k >= 0) ? k : null }; }).filter(d => d.k !== null);
                 if (plotData.length < 2) { throw new Error("No valid data points for material plot."); }
                 const xScale = d3.scaleLinear().domain([0, 1200]).range([0, dims.plotWidth]); const yScale = d3.scaleLinear().domain([0, 1.1]).range([dims.plotHeight, 0]);
                 drawAxes(g, xScale, yScale, null, dims, margin, { x: "Temperature (°C)", xOffset: 10, yLeft: "Reduction Factor (k)", yLeftOffset: 15, yLeftFormat: d3.format(".1f") });
                 const lineGen = d3.line().x(d => xScale(d.temp)).y(d => yScale(d.k)).defined(d => d.k !== null && isFinite(xScale(d.temp)) && isFinite(yScale(d.k)));
                 let lineClass = 'prop-yield-line'; // Default class
                 if (material === 'steel') lineClass = (property === 'yield') ? 'prop-yield-line' : 'prop-elastic-line';
                 else if (material === 'concrete') lineClass = (property === 'yield') ? 'concrete-line' : 'concrete-line prop-elastic-line'; // Use concrete base color, add elastic class for potential dash
                 drawLine(g, plotData, lineGen, lineClass);
                 // Make concrete elastic line dashed if needed (CSS handles dash based on class)
                 if (material === 'concrete' && property === 'elastic') { g.select(".prop-elastic-line").attr("stroke-dasharray", "4 2"); }

                 // Draw vertical line/point
                 const selectedK = reductionFn(selectedTemp);
                 const kValueSpan = document.getElementById('reductionFactorValue'); // Get span for k value
                 if (isFinite(selectedK) && selectedK >= 0) {
                     if(kValueSpan) kValueSpan.textContent = selectedK.toFixed(2); // Update k value display
                     const xPos = xScale(selectedTemp); const yPos = yScale(selectedK);
                     g.selectAll(".selected-temp-line, .selected-temp-point").remove();
                     g.append("line").attr("class", "selected-temp-line").attr("x1", xPos).attr("y1", dims.plotHeight).attr("x2", xPos).attr("y2", yPos);
                     g.append("circle").attr("class", "selected-temp-point").attr("cx", xPos).attr("cy", yPos).attr("r", 4);
                 } else { if(kValueSpan) kValueSpan.textContent = "N/A"; } // Handle invalid k
             } catch (error) { console.error(`Error updating ${context}:`, error); displayPlotError(plotDivId, `Plot Error: ${error.message}`); const kValueSpan = document.getElementById('reductionFactorValue'); if(kValueSpan) kValueSpan.textContent = "Err"; }
        }


        // --- Interactive Explosives Initiation Logic ---
        function updateExplosivesInitiation() {
             const context = "Explosives Initiation Interactive"; try { const boosterSlider = document.getElementById('boosterOutputSlider'); const sensitivitySlider = document.getElementById('chargeSensitivitySlider'); const confinementSlider = document.getElementById('confinementSlider'); const criticalDiameterOutput = document.getElementById('criticalDiameterOutput'); const explanationDiv = document.getElementById('initiation-explanation'); if (!boosterSlider || !sensitivitySlider || !confinementSlider || !criticalDiameterOutput || !explanationDiv || typeof boosterSlider.actualValue === 'undefined' || typeof sensitivitySlider.actualValue === 'undefined' || typeof confinementSlider.actualValue === 'undefined') { throw new Error("Explosives elements not found/initialized."); } const boosterOutput = boosterSlider.actualValue; const sensitivity = sensitivitySlider.actualValue; const confinement = confinementSlider.actualValue; const sensitivityLabels = {"1": "Very Low", "2": "Low", "3": "Medium", "4": "High", "5": "Very High"}; const confinementLabels = {"1": "None", "2": "Low", "3": "Medium", "4": "High"}; document.getElementById('chargeSensitivityValue').textContent = sensitivityLabels[sensitivity] || "Medium"; document.getElementById('confinementValue').textContent = confinementLabels[confinement] || "Low"; const base_dc = 50; const sensFactor = Math.exp(-(sensitivity - 3) * 0.8); const boostFactor = 1 / (1 + (boosterOutput - 5) * 0.15); const confFactor = 1 / (1 + (confinement - 2) * 0.25); let conceptual_dc = base_dc * sensFactor * boostFactor * confFactor; conceptual_dc = Math.max(5, Math.min(500, conceptual_dc)); if (!isFinite(conceptual_dc)) { criticalDiameterOutput.textContent = "Error"; explanationDiv.innerHTML = `<p class="text-[var(--error-color)]">Calculation error.</p>`; return; } criticalDiameterOutput.textContent = `${conceptual_dc.toFixed(0)} mm`; let explanation = []; explanation.push(`<strong>Conceptual Result:</strong> A ${conceptual_dc.toFixed(0)} mm critical diameter.`); if (boosterOutput > 7) explanation.push("<li>Strong booster output significantly helps initiation.</li>"); if (boosterOutput < 3) explanation.push("<li>Weak booster output makes initiation difficult.</li>"); if (sensitivity > 4) explanation.push("<li>Very sensitive charge initiates easily.</li>"); if (sensitivity < 2) explanation.push("<li>Very insensitive charge requires strong booster/confinement.</li>"); if (confinement > 3) explanation.push("<li>High confinement greatly aids initiation.</li>"); if (confinement < 2) explanation.push("<li>Lack of confinement makes initiation harder.</li>"); explanation.push("<br><em>Reminder: Illustrative model only.</em>"); explanationDiv.innerHTML = explanation.join(''); } catch (error) { console.error(`Error updating ${context}:`, error); const cdOutput = document.getElementById('criticalDiameterOutput'); const expDiv = document.getElementById('initiation-explanation'); if (cdOutput) cdOutput.textContent = "Error"; if (expDiv) expDiv.innerHTML = `<p class="text-[var(--error-color)]">Error updating display.</p>`; }
        }

        // --- Interactive Aerosol Flammability Logic ---
        function updateAerosolFlammabilityPlot() {
             const plotDivId = "aerosol-flammability-plot"; const context = "Aerosol Flammability Plot"; try { const smdSlider = document.getElementById('smdSlider'); const rangeOutput = document.getElementById('flammabilityRangeOutput'); if (!smdSlider || !rangeOutput || typeof smdSlider.actualValue === 'undefined') { throw new Error("Aerosol controls not found/initialized."); } const smd = smdSlider.actualValue; const margin = {top: 20, right: 30, bottom: 40, left: 50}; const { g, dims } = setupPlotArea(plotDivId, margin); const gasLFL = 50; const gasUFL = 300; const calculateLFL = (d) => { if (d < 10) return gasLFL; const dipCenter = 50; const dipWidth = 40; const dipDepth = 0.4 * gasLFL; const dip = dipDepth * Math.exp(-Math.pow(d - dipCenter, 2) / (2 * dipWidth**2)); const rise = 0.1 * gasLFL * Math.max(0, (d - 100) / 400); return Math.max(5, gasLFL - dip + rise); }; const calculateUFL = (d) => { if (d < 10) return gasUFL; const peakCenter = 70; const peakWidth = 60; const peakHeight = 2.0 * gasUFL; const peak = peakHeight * Math.exp(-Math.pow(d - peakCenter, 2) / (2 * peakWidth**2)); const decrease = 0.5 * gasUFL * Math.max(0, (d - 150) / 350); return Math.max(gasUFL * 1.1, gasUFL + peak - decrease); }; const smdRange = d3.range(5, 501, 5); const plotData = smdRange.map(d => ({ smd: d, lfl: calculateLFL(d), ufl: calculateUFL(d) })).filter(p => isFinite(p.smd) && isFinite(p.lfl) && isFinite(p.ufl)); if (plotData.length < 2) { throw new Error("No valid data points for aerosol plot."); } const xScale = d3.scaleLinear().domain([0, 500]).range([0, dims.plotWidth]); const maxUFL = d3.max(plotData, d => d.ufl) || gasUFL * 3; const yScale = d3.scaleLog().domain([Math.max(1, gasLFL * 0.2), maxUFL * 1.2]).range([dims.plotHeight, 0]).nice(); drawAxes(g, xScale, yScale, null, dims, margin, { x: "Droplet SMD (µm)", xOffset: 10, yLeft: "Concentration (g/m³, log scale)", yLeftOffset: 20, yLeftFormat: d3.format(".0f") }); g.append("g").attr("class", "grid").call(d3.axisLeft(yScale).ticks(5, ".0f").tickSize(-dims.plotWidth).tickFormat("")); const lineGen = (yAccessor) => d3.line().x(d => xScale(d.smd)).y(d => yScale(d[yAccessor])).defined(d => d[yAccessor] !== null && isFinite(xScale(d.smd)) && isFinite(yScale(d[yAccessor]))); drawLine(g, plotData, lineGen('lfl'), 'lfl-line'); drawLine(g, plotData, lineGen('ufl'), 'ufl-line'); g.append("line").attr("x1", 0).attr("x2", dims.plotWidth).attr("y1", yScale(gasLFL)).attr("y2", yScale(gasLFL)).style("stroke", "var(--accent-color)").attr("stroke-dasharray", "2 2").style("opacity", 0.7); g.append("line").attr("x1", 0).attr("x2", dims.plotWidth).attr("y1", yScale(gasUFL)).attr("y2", yScale(gasUFL)).style("stroke", "var(--error-color)").attr("stroke-dasharray", "2 2").style("opacity", 0.7); g.append("text").attr("x", dims.plotWidth - 5).attr("y", yScale(gasLFL) - 3).text("Gas LFL").style("font-size", "8px").style("fill", "var(--accent-color)").attr("text-anchor", "end"); g.append("text").attr("x", dims.plotWidth - 5).attr("y", yScale(gasUFL) + 8).text("Gas UFL").style("font-size", "8px").style("fill", "var(--error-color)").attr("text-anchor", "end"); const selectedLFL = calculateLFL(smd); const selectedUFL = calculateUFL(smd); if (isFinite(selectedLFL) && isFinite(selectedUFL)) { rangeOutput.textContent = `LFL: ${selectedLFL.toFixed(0)} g/m³ | UFL: ${selectedUFL.toFixed(0)} g/m³`; const xPos = xScale(smd); g.selectAll(".selected-smd-line").remove(); g.append("line").attr("class", "selected-smd-line").attr("x1", xPos).attr("y1", dims.plotHeight).attr("x2", xPos).attr("y2", 0).style("stroke", "var(--accent-yellow)").attr("stroke-dasharray", "4 4"); } else { rangeOutput.textContent = "LFL: N/A | UFL: N/A"; } } catch (error) { console.error(`Error updating ${context}:`, error); displayPlotError(plotDivId, `Plot Error: ${error.message}`); const rangeOut = document.getElementById('flammabilityRangeOutput'); if(rangeOut) rangeOut.textContent = "Error"; }
        }

        // --- Interactive Fuzzy Risk Prioritization Logic ---
        function updateFuzzyRisk() {
            const context = "Fuzzy Risk Interactive"; try { const cSelect = document.getElementById('consequenceSelect'); const pSelect = document.getElementById('probabilitySelect'); const eSelect = document.getElementById('exposureSelect'); const rpnOutput = document.getElementById('rpnOutput'); const riskLevelOutput = document.getElementById('rpnRiskLevel'); const explanationDiv = document.getElementById('risk-explanation'); if (!cSelect || !pSelect || !eSelect || !rpnOutput || !riskLevelOutput || !explanationDiv) { throw new Error("Fuzzy risk elements not found."); } const fuzzyMap = { 'VL': { l: 0, m: 0, u: 1 }, 'L': { l: 0, m: 1, u: 3 }, 'LM': { l: 1, m: 3, u: 5 }, 'M': { l: 3, m: 5, u: 7 }, 'AH': { l: 5, m: 7, u: 9 }, 'H': { l: 7, m: 9, u: 10 }, 'VH': { l: 9, m: 10, u: 10 } }; const cVal = cSelect.value; const pVal = pSelect.value; const eVal = eSelect.value; const cFuzzy = fuzzyMap[cVal]; const pFuzzy = fuzzyMap[pVal]; const eFuzzy = fuzzyMap[eVal]; if (!cFuzzy || !pFuzzy || !eFuzzy) { throw new Error("Invalid linguistic selection."); } const defuzzify = (f) => (f.l + 4 * f.m + f.u) / 6; const cCrisp = defuzzify(cFuzzy); const pCrisp = defuzzify(pFuzzy); const eCrisp = defuzzify(eFuzzy); const wC = 0.538; const wP = 0.294; const wE = 0.167; const maxPossibleCrisp = defuzzify(fuzzyMap['VH']); const cNorm = Math.max(0, cCrisp / maxPossibleCrisp); const pNorm = Math.max(0, pCrisp / maxPossibleCrisp); const eNorm = Math.max(0, eCrisp / maxPossibleCrisp); const conceptualRPN = (wC * cNorm + wP * pNorm + wE * eNorm) * 1000; if (!isFinite(conceptualRPN)) { throw new Error("RPN calculation failed."); } let riskLevel = "Low Risk"; let riskColor = "text-green-500"; if (conceptualRPN > 600) { riskLevel = "Very High Risk"; riskColor = "text-[var(--error-color)]"; } else if (conceptualRPN > 400) { riskLevel = "High Risk"; riskColor = "text-orange-500"; } else if (conceptualRPN > 200) { riskLevel = "Substantial Risk"; riskColor = "text-yellow-500"; } else if (conceptualRPN > 100) { riskLevel = "Possible Risk"; riskColor = "text-[var(--text-color-subtle)]"; } rpnOutput.textContent = conceptualRPN.toFixed(0); riskLevelOutput.textContent = riskLevel; riskLevelOutput.className = `text-sm font-semibold mt-1 ${riskColor}`; explanationDiv.innerHTML = `<p>Defuzzified Scores (~0-10): C: ${cCrisp.toFixed(1)}, P: ${pCrisp.toFixed(1)}, E: ${eCrisp.toFixed(1)}</p><p>Conceptual Weighted RPN (0-1000): ${conceptualRPN.toFixed(0)}</p><p>Resulting Risk Level: <span class="${riskColor} font-bold">${riskLevel}</span></p><br><em>Based on fuzzy mapping/weights from Soltani et al. (2024). RPN calc. simplified.</em>`; } catch (error) { console.error(`Error updating ${context}:`, error); const rpnOut = document.getElementById('rpnOutput'); const riskLvlOut = document.getElementById('rpnRiskLevel'); const expDiv = document.getElementById('risk-explanation'); if(rpnOut) rpnOut.textContent = "Error"; if(riskLvlOut) riskLvlOut.textContent = ""; if(expDiv) expDiv.innerHTML = `<p class="text-[var(--error-color)]">Error updating display.</p>`; }
        }


        // --- Global Setup Functions ---
        /** Initializes all interactive elements on the page */
        function setupAllInteractives() {
            try {
                 // Material Property Plot Controls
                 setupControl('materialSelect', 'materialSelect', { callback: updateMaterialPlot, isSelect: true });
                 setupControl('propertySelect', 'propertySelect', { callback: updateMaterialPlot, isSelect: true });
                 setupControl('temperatureSlider', 'temperatureValue', { fixedDigits: 0, callback: updateMaterialPlot, valueFormatFn: (val) => `T = ${val.toFixed(0)} °C | k ≈ ` });

                // Explosives Initiation Controls
                setupControl('boosterOutputSlider', 'boosterOutputValue', { fixedDigits: 0, callback: updateExplosivesInitiation });
                // Use selectMap for display text for sensitivity/confinement sliders
                setupControl('chargeSensitivitySlider', 'chargeSensitivityValue', { fixedDigits: 0, callback: updateExplosivesInitiation, selectMap: {"1": "Very Low", "2": "Low", "3": "Medium", "4": "High", "5": "Very High"} });
                setupControl('confinementSlider', 'confinementValue', { fixedDigits: 0, callback: updateExplosivesInitiation, selectMap: {"1": "None", "2": "Low", "3": "Medium", "4": "High"} });

                 // Aerosol Flammability Controls
                 setupControl('smdSlider', 'smdValue', { fixedDigits: 0, callback: updateAerosolFlammabilityPlot });

                 // Fuzzy Risk Controls (Select elements)
                 setupControl('consequenceSelect', 'consequenceSelect', { callback: updateFuzzyRisk, isSelect: true });
                 setupControl('probabilitySelect', 'probabilitySelect', { callback: updateFuzzyRisk, isSelect: true });
                 setupControl('exposureSelect', 'exposureSelect', { callback: updateFuzzyRisk, isSelect: true });

            } catch (error) {
                console.error("Error setting up one or more interactive elements:", error);
            }
        }

        /** Renders all plots/outputs that should be visible on initial page load */
        function renderAllPlotsInitial() {
             const initialRenderFunctions = [
                 updateMaterialPlot,
                 updateExplosivesInitiation,
                 updateAerosolFlammabilityPlot,
                 updateFuzzyRisk
             ];
             initialRenderFunctions.forEach(renderFunc => {
                 if (typeof renderFunc === 'function') {
                     try { renderFunc(); }
                     catch (e) { console.error(`Error during initial call to ${renderFunc.name}:`, e); }
                 } else { console.warn("Initial render function not found:", renderFunc); }
             });
         }

        /** Sets up smooth scrolling for internal navigation links */
        function setupSmoothScrolling(){
             try {
                 document.querySelectorAll('nav a[href^="#"]').forEach(anchor => {
                     anchor.addEventListener('click', function (e) {
                         e.preventDefault(); const targetId = this.getAttribute('href'); const targetElement = document.querySelector(targetId);
                         if(targetElement) {
                             const headerNavHeight = (document.querySelector('header')?.offsetHeight || 88) + (document.querySelector('nav')?.offsetHeight || 34);
                             const headerOffset = headerNavHeight + 15; // Add buffer
                             const offsetPosition = targetElement.getBoundingClientRect().top + window.pageYOffset - headerOffset;
                             window.scrollTo({ top: offsetPosition, behavior: "smooth" });
                         } else { console.warn("Smooth scroll target not found:", targetId); }
                     });
                 });
             } catch (e) { console.error("Error setting up smooth scrolling:", e); }
         }

        // --- Initialization on DOM Load ---
        document.addEventListener('DOMContentLoaded', function () {
             try {
                 setupAllInteractives();
                 // Delay initial rendering slightly
                 setTimeout(() => { renderAllPlotsInitial(); }, 50);
                 setupSmoothScrolling();
                 // Typeset MathJax after initial rendering and layout adjustments
                 if (typeof MathJax !== 'undefined' && typeof MathJax.typesetPromise === 'function') {
                     setTimeout(() => { MathJax.typesetPromise().catch((err) => console.error('MathJax typesetting failed:', err)); }, 200); // Increased delay
                 } else { console.warn("MathJax or typesetPromise not available."); }
             } catch (error) {
                 console.error("CRITICAL ERROR during initial setup:", error);
                 // Display a user-friendly message if setup fails critically
                 const mainContainer = document.querySelector('main.container');
                 if (mainContainer) {
                     mainContainer.innerHTML = `<p class="text-center text-red-600 font-bold mt-10">A critical error occurred loading interactive content. Please try refreshing the page.</p>`;
                 } else {
                    alert("A critical error occurred during page initialization. Some interactive elements may not work.");
                 }
             }
         });

    </script>

</body>
</html>




